<?xml version="1.0" encoding="utf-8"?>
<ContentView x:Class="VermutRaterApp.Views.Templates.FavoritoVermutView"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:conv="clr-namespace:VermutRaterApp.Converters"
             xmlns:ui="clr-namespace:VermutRaterApp.Controls"
             x:Name="Root"
             BackgroundColor="Transparent"
             Padding="0"
             HorizontalOptions="Fill">

    <ContentView.Resources>
        <conv:PuntuacioVisibleConverter x:Key="PuntuacioVisibleConverter" />
        <OnIdiom x:Key="CardAspect" x:TypeArguments="x:Double" Phone="1.26" Tablet="1.24" />
    </ContentView.Resources>

    <!-- Alto = Ancho * Aspect -->
    <ui:AspectBox Aspect="{StaticResource CardAspect}" HorizontalOptions="Fill" VerticalOptions="Start">
        <Grid>
            <Grid.GestureRecognizers>
                <TapGestureRecognizer Tapped="OnFrameTapped"/>
            </Grid.GestureRecognizers>

            <!-- Marco -->
            <Image Source="vmarcpreferit.png"
                   Aspect="AspectFit"
                   HorizontalOptions="Fill"
                   VerticalOptions="Fill"
                   InputTransparent="True"/>

            <!-- Contenido centrado -->
            <Grid ZIndex="1" RowSpacing="1" ColumnSpacing="0" Padding="0">
                <!-- filas: * para centrar verticalmente el bloque -->
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <!-- Título -->
                    <RowDefinition Height="Auto"/>
                    <!-- Origen -->
                    <RowDefinition Height="Auto"/>
                    <!-- Estrellas -->
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- columnas: * | Auto | * para centrar horizontalmente -->
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>


                <!-- TÍTULO -->
                <Label Grid.Row="1" Grid.Column="1"
                       Text="{Binding Nombre, Converter={StaticResource FixedWidthWrapConverter}}" 
                    FontSize="24"
                       FontAttributes="Bold"
                       FontFamily="CinzelDecorative-Regular"
                       TextColor="#E6C17A"
                       HorizontalOptions="Center"
                       HorizontalTextAlignment="Center"
                       LineBreakMode="WordWrap"
                       MaxLines="3" />
                <!-- ORIGEN -->
                <Grid Grid.Row="2" Grid.Column="1" ColumnSpacing="8" HorizontalOptions="Center">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <Image Grid.Column="0" Source="mapa_icono2.png" HeightRequest="22" WidthRequest="22"/>
                    <Label Grid.Column="1"
                           Text="{Binding Origen}"
                           FontFamily="EBGaramond-Regular"
                           FontSize="20"
                           TextColor="#E6C17A"
                           HorizontalTextAlignment="Center"/>
                </Grid>



                <!-- ESTRELLAS -->
                <Grid Grid.Row="3" Grid.Column="1" ColumnSpacing="6" HorizontalOptions="Center">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <Image Grid.Column="0" Source="estrella_activa.png" HeightRequest="22" WidthRequest="22"
                           IsVisible="{Binding MiPuntuacion, Converter={StaticResource PuntuacioVisibleConverter}, ConverterParameter=1}" />
                    <Image Grid.Column="1" Source="estrella_activa.png" HeightRequest="22" WidthRequest="22"
                           IsVisible="{Binding MiPuntuacion, Converter={StaticResource PuntuacioVisibleConverter}, ConverterParameter=2}" />
                    <Image Grid.Column="2" Source="estrella_activa.png" HeightRequest="22" WidthRequest="22"
                           IsVisible="{Binding MiPuntuacion, Converter={StaticResource PuntuacioVisibleConverter}, ConverterParameter=3}" />
                    <Image Grid.Column="3" Source="estrella_activa.png" HeightRequest="22" WidthRequest="22"
                           IsVisible="{Binding MiPuntuacion, Converter={StaticResource PuntuacioVisibleConverter}, ConverterParameter=4}" />
                    <Image Grid.Column="4" Source="estrella_activa.png" HeightRequest="22" WidthRequest="22"
                           IsVisible="{Binding MiPuntuacion, Converter={StaticResource PuntuacioVisibleConverter}, ConverterParameter=5}" />
                </Grid>
            </Grid>
        </Grid>
    </ui:AspectBox>
</ContentView>
